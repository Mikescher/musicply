<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>MusicPly</title>

    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="stylesheet" type="text/css" href="/reset.css" />
    <link rel="stylesheet" type="text/css" href="/styles.css" />
    <script type="text/javascript" src="/knockout-3.5.1.js"></script>
    <script type="text/javascript" src="/knockout-mapping-2.4.1.js"></script>
</head>

<body>

    <main>

        <div class="container_left">

            <div class="left_header">

                <img draggable="false" src="logo.png" alt="logo">
                <span class="title">MusicPly</span>

            </div>

            <div class="container_playlists">

                <div data-bind="template: { name: 'template-playlist-entry', foreach: playlists_root.children }"></div>

                <script type="text/html" id="template-playlist-entry">
                    {{ safe "<!-- ko ifnot: (children !== null && children.length > 0) -->" }}
                        <div class="item entry normal" data-bind="css: { active: active }, click: $root.onPlaylistClick"><span class="title" data-bind="text: name"></span></div>
                    {{ safe "<!-- /ko -->" }}

                    {{ safe "<!-- ko if: (children !== null && children.length > 0) -->" }}
                        <div class="item entry expand" data-bind="css: { active: active }, click: $root.onPlaylistClick"><span class="title" data-bind="text: name"></span></div>
                        <div class="item entry children">
                            <div data-bind="template: { name: 'template-playlist-entry', foreach: children }"></div>
                        </div>
                    {{ safe "<!-- /ko -->" }}
                </script>

            </div>

            <div class="left_footer">

                {{ range .FooterLinks }}

                    <a class="button" draggable="false" href="{{.Link}}" title="{{.Name}}">
                        <img alt="{{.Name}}" src="/footerlinks/{{.ID}}/icon" draggable="false">
                        <span> {{.Name}}</span>
                    </a>

                {{ end }}

            </div>

        </div>

        <div class="container_tracks" data-bind="css: { loading: tracksLoading, empty: (!tracksLoading && tracks.length === 0), initial: tracksInitial }">

            {{ safe "<!-- ko if: tracksLoading -->" }}
                <div data-bind="if: tracksLoading" class="window loading-dlg" style="width: 320px">
                    <div class="title-bar">
                        <div class="title-bar-text">Loading...</div>
                    </div>
                    <div class="window-body">
                        <div class="lds-spinner"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
                    </div>
                </div>
            {{ safe "<!-- /ko -->" }}

            {{ safe "<!-- ko if: tracksInitial -->" }}
                <img class="logoInitial" draggable="false" src="logo.png" alt="logo">
            {{ safe "<!-- /ko -->" }}

            {{ safe "<!-- ko foreach: tracks -->" }}
                <div class="track">
                    <span data-bind="text: id" class="track_id"></span>
                    <span data-bind="text: sourceID" class="source_id"></span>
                    <span data-bind="text: playlistID" class="playlist_id"></span>

                    <div class="cover">
                        <img draggable="false" alt="cover" data-bind="attr: { src: ('/api/v' + $root.apiLevel + '/playlists/' + playlistID + '/tracks/' + id + '/cover') }">
                    </div>

                    <div class="col-2">
                        <span data-bind="text: (tags.title ?? '')" class="title"></span>
                        <span class="album"><span data-bind="text: (tags.album ?? '')"></span><span> </span><span data-bind="if: (tags.trackIndex !== null && tags.trackTotal !== null)" class="trackindex">[ <span data-bind="text: (tags.trackIndex ?? '')"></span> / <span data-bind="text: (tags.trackTotal ?? '')"></span> ]</span></span>
                        <span data-bind="text: (tags.artist ?? '')" class="artist">Bloodhound Gang</span>
                    </div>

                    <div class="col-3">
                        <span data-bind="text: (tags.year ?? '')" class="year"></span>
                        <span data-bind="text: (tags.genre ?? '')" class="genre"></span>

                        <span class="codec">
                            <span data-bind="text: (audioMeta.codecShort ?? '')"></span>
                            {{ safe "<!-- ko if: (audioMeta.bitRate !== null) -->" }}
                                &nbsp;
                                <span data-bind="text: ('@ ' + audioMeta.bitRate + ' kbit')" class="bitrate"></span>
                            {{ safe "<!-- /ko -->" }}
                        </span>

                        <span class="grow"></span>

                        <span data-bind="text: (audioMeta.duration)" class="length"></span>

                        <span data-bind="text: (audioMeta.channels)" class="channels"></span>

                        <span data-bind="text: (fileMeta.ctime)" class="ctime"></span>
                        <span data-bind="text: (fileMeta.size + ' MB')" class="size"></span>

                        <span data-bind="text: (audioMeta.samplerate)" class="samplerate"></span>
                    </div>

                    <button class="btn_play"  ><img draggable="false" src="/icn_play.svg"    alt="play"></button>
                    <button class="btn_equeue"><img draggable="false" src="/icn_enqueue.svg" alt="enqueue"></button>
                </div>
            {{ safe "<!-- /ko -->" }}


        </div>

        <div class="container_queue">

            <div class="queue">

                <div class="queue_item past">
                    <span class="title">Mama's Boy</span>
                    <span class="length">3:39</span>
                </div>

                <div class="queue_item past">
                    <span class="title">The Inevitable Return Of The Great White Dope</span>
                    <span class="length">3:39</span>
                </div>

                <div class="queue_item active">

                    <div class="cover">
                        <img draggable="false" alt="cover" src="no_cover.png">
                    </div>

                    <span class="title">I Hope You Die</span>
                    <span class="album">Hooray For Boobies</span>
                    <span class="artist">Bloodhound Gang</span>

                    <input class="range" type="range" min="1" max="11" value="5">
                    <span class="length">3:39</span>
                </div>

                <div class="queue_item future">
                    <span class="title">Three Point One Four</span>
                    <span class="length">3:39</span>
                </div>

            </div>

            <div class="queue_footer">
                <button class="btn btn_clear"    ><img draggable="false" src="/icn_clear.svg"  alt="play"><span>Clear</span></button>
                <div class="grow"></div>
                <button class="btn btn_playpause"><img draggable="false" src="/icn_pause.svg"  alt="pause"></button>
            </div>

        </div>

    </main>

    <footer>
        <span class="footer-cell branch_name">{{ .BranchName }}</span>
        <span class="footer-cell commit_time">{{ .CommitTime }}</span>
        <span class="footer-cell commit_hash">{{ .CommitHash }}</span>
        <span class="footer-cell commit_hash">{{ .DBChecksum }}</span>
        <span class="footer-cell grow"></span>
        <span class="footer-cell name">MusicPly</span>
    </footer>

    <script type="text/javascript" src="/scripts/{{ .DBChecksum }}.js"></script>

</body>
</html>